# Broken for 4.17, TODO: update if needed again to restore times.
#Manipulate reading stats:
#  - Enabled: no
#  - Description: Always add 10 hours to the reading time every time you close a book.
#  # in EventEngine::endReadingSession(*Volume) when recording end of reading session stats, change QDateTime::secsTo calls to a fixed value
#  - ReplaceBytes: {Offset: 0x4F429C, FindBLX: 0x441348, ReplaceH: 4F F6 FF 70} # MOV  r0, #65535
#  - ReplaceBytes: {Offset: 0x4F42BC, FindBLX: 0x441348, ReplaceH: 4F F6 FF 70} # MOV  r0, #65535

Stuff: [Enabled: yes, ReplaceBytes: {Offset: 0x6A8632, FindH: FFF520EB, ReplaceH: 4FF00100}, ReplaceBytes: {Offset: 0x70CDC6, FindH: 89F582EB, ReplaceH: 4FF00100}, ReplaceBytes: {Offset: 0x7119C2, FindH: 84F584ED, ReplaceH: 4FF00100}]

Customize ComfortLight settings:
  - Enabled: no
  - Description: |
      Change the times available in the ComfortLight bedtime dropdown and the
      start/end times for the color changes. All values in this patch are
      customizable.

      The default values for this patch give you 21 options between 5PM and 3AM
      at 30 minute intervals, with the colour change starting at 4PM, and the
      change back to blue between 5AM and 7AM. The firmware default is 13 options
      between 9PM-3AM at 30 minute intervals, with the transition starting at 6PM.
    #
    # In an unnamed subroutine two layers into FrontLightPopupController::loadView
    # (find it by going back from QTime::addSecs), the times for the dropdown are
    # generated into a QVector<QPair<QString, QTime>> with a simple loop.
    #
  # Change the starting hour passed to the QTime constructor (mov r1, #21):
  - ReplaceInt: {Offset: 0xA50E3E, Find: 21, Replace: 17} # 21:00 (9PM) -> 17:00 (5PM)
  # Optional: Change the increment passed to QTime::addSecs (you need to use an
  # ARM assembler to change this value):
  - ReplaceBytes: {Offset: 0xA50EA2, FindH: 4F F4 E1 61, ReplaceH: 4F F4 E1 61} # mov.w r1, #1800: 30m
  # Change the number of increments (movs r5, #13):
  - ReplaceInt: {Offset: 0xA50E76, Find: 13, Replace: 21} # 13 [9PM..3AM]+30m -> 21 [5PM..3AM]+30m
  # Change the number of pre-allocated elements (I don't think this is actually
  # required, as Qt will realloc as necessary, but we might as well do this just
  # in case) (mov r1, #21):
  - ReplaceInt: {Offset: 0xA510DE, Find: 13, Replace: 21} # same as prev replacement
    #
    # The actual color adjustment is done in BedtimeManager::adjustTemperature.
    # The color temperature is based on the current time, the bedtime, the hardcoded
    # sunset, the hardcoded sunrise start, the hardcoded sunrise end, the daytime
    # temperature, and the nighttime temperature.
    #
  # Change the sunset time (the transition to a warmer temperature starts here
  # and transitions until the bedtime chosen) (this should be 1-3 hours before
  # the minimum bedtime from the first replacement above) (mov r1, #18):
  - ReplaceInt: {Offset: 0xA49A06, Find: 18, Replace: 16} # 18:00 (9PM-3=6PM) -> 16:00 (5PM-1=4PM)
  # Optional: Change the sunrise start time (the transition back to a cooler
  # temperature starts here) (this should be sometime after the last bedtime,
  # but before the sunset time) (mov r1, #5):
  - ReplaceInt: {Offset: 0xA49A28, Find: 5, Replace: 5} # 5AM
  # Optional: Change the sunrise end time (the transition back to a cooler
  # temperature ends here) (this should be 1-3 hours after the sunrise start but
  # before the sunset time or bad things will happen with negative values) (mov r1, #7):
  - ReplaceInt: {Offset: 0xA499F2, Find: 7, Replace: 7} # 5AM+2=7AM

Show natural light menu on all devices:
  - Enabled: no
  - Description: |
      Just for testing the previous patch, will show the slider and dropdown,
      but won't actually do anything other than change the config file.
  # Show slider in FrontLightPopupController::loadView:
  - ReplaceBytes: {Offset: 0xA51E8A, FindBLX: 0x4C8984, ReplaceH: 4F F0 01 00}
  - ReplaceBytes: {Offset: 0xA51FC8, FindBLX: 0x4C8984, ReplaceH: 4F F0 01 00}

Invert page turn buttons:
  - Enabled: no
  # In ReadingView::keyPressEvent(QKeyEvent*), invert the branch to next page:
  - ReplaceBytes: {Offset: 0xAD2824, FindH: 28 B9, ReplaceH: 28 B1} # CBNZ R0, #0xE -> CBZ R0, #0xE
